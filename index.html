<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic Auth Login RUM</title>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
        }
        form {
            display: inline-block;
            text-align: left;
        }
        input[type="text"], input[type="password"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
        }
        input[type="submit"] {
            width: 100%;
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
        }
        input[type="submit"]:hover {
            background-color: #0056b3;
        }
        .image-container {
            margin: 20px 0;
        }
        .image-container img {
            width: 300px;
            height: 200px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
    </style>
   
    <script defer src='https://g.3gl.net/jp/11569/v4.0.5/InitialLoadScript.js'></script>
    <script>

	    function getCookie(cname) {
				var name = cname + "=";
				var ca = document.cookie.split(';');
				for(var i = 0; i < ca.length; i++) {
				var c = ca[i];
				while (c.charAt(0) == ' ') {
	  				c = c.substring(1);
				}
				if (c.indexOf(name) == 0) {
	  				return c.substring(name.length, c.length);
				}
				}
				return "";
		}

	    var pageInstanceIdVal = document.getElementsByClassName("analytics-mobile-data")[0].getAttribute("data-pageinstanceid");
	    var pageNameVal = document.getElementsByClassName("analytics-mobile-data")[0].getAttribute("data-pagename");
			var isMobileLayout = window.matchMedia('only screen and (max-width: 1023px)').matches;
			var sysEnvValue = isMobileLayout ? 'mobile':'desktop';
			var webVal = "web" + (isMobileLayout?'m':'');
	    var visitorType = getCookie("ps")? "signed_in" : "guest";

	    if(visitorType == "signed_in"){
	    	var profileID = getCookie("ud");
	    	var subscriptionType = getCookie("ty");
	    	var subscriptionStatus = getCookie("ss");
	    	var subscriptionTier =  getCookie("st");
	    	var subscriptionDuration = getCookie("sd");
	    	var subscriptionFlag = getCookie("sf");
	    }
	    else
	    {
	    	var profileID = '';
	    	var subscriptionType = '';
	    	var subscriptionStatus = '';
	    	var subscriptionTier = '';
	    	var subscriptionDuration = '';
	    	var subscriptionFlag = '';
	    }

		var digitalData = digitalData || {};
		
		// var originalReferrer = sessionStorage.getItem('oR'), 
		// referrer = originalReferrer !== null ? originalReferrer : document.referrer;
		// sessionStorage.removeItem('oR');

		function updateReferrer() {
			var queueItReferrer = getCookie('q_i_t_u_i');
			if(queueItReferrer) {
				if (document.referrer === 'https://psdirect-queue.playstation.com/') {
					var originalReferrer = decodeURIComponent(queueItReferrer).match(
						/(?:(?:https?|ftp):\/\/)?[\w/\-?=%.]+\.[\w/\-&?=%.]+/g
					)[0];
					return originalReferrer;
				} else {
					return document.referrer;
				}
			} else {
				return document.referrer;
			}
		}
			var referrer = updateReferrer();

			var queueItFlag = document.referrer === 'https://psdirect-queue.playstation.com/' ? 'ps-direct-eu' : '';
		
		digitalData = {
			pageInstanceID: webVal+pageInstanceIdVal ,
			page:{
				pageInfo:{
					pageName: webVal+pageNameVal,
					sysEnv: sysEnvValue ,
					category:{
						primaryCategory:"pdp"
					},
					destinationURL:"https://direct.playstation.com/de-de/buy-accessories/disc-drive-for-ps5-digital-edition-consoles",
					version:"prod",
					referrer: referrer,
					queueItFlag : queueItFlag
				}
			},
			user:{
				profile:{
					profileInfo:{
						profileID:profileID,
						language:"de-de",
						attributes:{
							visitorType:visitorType
							
						}
					},
					subscriptionInfo:[
                         { 
                          subscriptionState:{
                            subscriptionType: subscriptionType,
                            subscriptionStatus: subscriptionStatus,
                            subscriptionTier: subscriptionTier, 
                            subscriptionDuration: subscriptionDuration,
                            subscriptionFlag: subscriptionFlag
                          }
                         }
                       ],
					privacyInfo:{
                            ws2Settings:{
                    		personalizedAds: '', 
                    		personalizedRecommendations: '',
                    		personalizedMedia: '',
                    		personalizedMaster: ''
                		}
           		 	}					
				}
			},
			technology:{
				attributes:{
					userAgent:"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.61 Safari/537.36"
				}
			},
			commerceEvent:{
				eventInfo:{
					eventName:''
				}
			},
			cartInstance:{},
			cart:{},
			transaction:{},
			product:[{
				productInfo:''
            }],
            event:{
                eventInfo:{
                    eventName:'',
                    eventAction: ''
                },
                attributes: {
                   
                }
            },
            checkoutApp: {
                visible: undefined,
                quantityChanged: undefined
            },
            productInstance:{

			},
            returnData:{
                purchaseID: '', 
                returnID: '', 
                returnTotals:{ 
                    returnSubTotal: '',
                    returnTotal: '',
                    currency: ''
                },   
            }
		};

		if(window.RProfiler){
				window.RProfiler.addInfo('tracepoint', 'locale', digitalData.user.profile.profileInfo.language);
				window.RProfiler.addInfo('tracepoint', 'ckey', getCookie("psd-correlation-key"));
				window.RProfiler.addInfo('tracepoint', 'category', digitalData.page.pageInfo.pageName );
				window.RProfiler.addInfo('tracepoint', 'loggedin', digitalData.user.profile.profileInfo.attributes.visitorType);
		}
            </script>
    <script>
        function getQueryParams() {
            const params = new URLSearchParams(window.location.search);
            const queryParams = {};
            for (const [key, value] of params.entries()) {
                queryParams[key] = value;
            }
            return queryParams;
        }

        function handleQueryParams() {
            const queryParams = getQueryParams();
            if (queryParams.anystring) {
                document.getElementById('query-result').innerText = `Query Parameter: ${queryParams.anystring}`;
            }
        }

        function waitForRProfiler(retries = 20, interval = 500) {
            console.log("Checking for RProfiler...");
            let attempts = 0;
            const checkInterval = setInterval(() => {
                if (window.RProfiler && typeof window.RProfiler.addInfo === "function") {
                    console.log("‚úÖ RProfiler detected. Sending tracepoint...");
                    window.RProfiler.addInfo('tracepoint', 'abc', 123);
                    console.log("üöÄ Tracepoint 'abc' with value 123 sent successfully.");
                    clearInterval(checkInterval);
                } else {
                    attempts++;
                    console.warn(`‚ö†Ô∏è RProfiler not available yet. Attempt ${attempts}/${retries}`);
                    if (attempts >= retries) {
                        console.error("‚ùå Failed to detect RProfiler after max attempts.");
                        clearInterval(checkInterval);
                    }
                }
            }, interval);
        }

        window.onload = function() {
            console.log("üìå Window Loaded. Initializing scripts...");
            handleQueryParams();
            waitForRProfiler(); // Start checking for RProfiler
        };

        function handleLogin(event) {
            event.preventDefault();

            const validUsername = 'aaaaa';
            const validPassword = 'aaaaa';

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === validUsername && password === validPassword) {
                alert('Login successful!');
                window.location.href = 'Welcome.html';
            } else {
                alert('Invalid credentials. Please try again.');
            }
        }
    </script>
</head>
<body>
    <div class="image-container">
        <img src="https://picsum.photos/300/200?random=1" alt="Random Image 1">
    </div>

    <h1>Login</h1>
    <form onsubmit="return handleLogin(event);">
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" required>

        <div class="image-container">
            <img src="https://picsum.photos/300/200?random=2" alt="Random Image 2">
        </div>

        <label for="password">Password:</label>
        <input type="password" id="password" name="password" required>

        <input type="submit" value="Login">
    </form>

    <div class="image-container">
        <img src="https://picsum.photos/300/200?random=3" alt="Random Image 3">
    </div>

    <p id="query-result"></p>
</body>
</h
